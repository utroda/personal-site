import{c as e,r as a,m as t}from"./render-template.Cc8N62nc.js";import{u as p}from"./hoisted.CzQnbSJV.js";import"./astro/assets-service.DcMRmNXG.js";const n=`<p>Accordions are a common UI pattern used to manage content in a collapsible and expandable manner. They are especially useful when dealing with a large amount of information that needs to be organized and presented in a structured way. However, when implementing accordions, it’s crucial to ensure accessibility for all users, including those who rely on assistive technologies like screen readers or keyboard navigation. In this blog post, we’ll walk through the process of creating an accessible-friendly accordion component using Vue 3, along with writing unit tests to verify its functionality in Part 2.</p>
<h2 id="gather-requirements">Gather Requirements</h2>
<p>Before we begin, it’s essential to gather some information about the accessibility (a11y) requirements for an Accordion component. Fortunately, <a href="https://www.w3.org/WAI/ARIA/apg/patterns/accordion/" rel="nofollow, noopener, noreferrer" target="_blank">w3.org</a> provides valuable insights for us. After reviewing the Accordion Pattern guidelines, we can summarize the following key points:</p>
<h4 id="accordions-have-two-primary-sections">Accordions have two primary sections</h4>
<ul>
<li><strong>Accordion Header:</strong> Label for or thumbnail representing a section of content that also serves as a control for showing, and in some implementations, hiding the section of content.</li>
<li><strong>Accordion Panel:</strong> Section of content associated with an accordion header.</li>
</ul>
<h4 id="a11y-requirements">A11y Requirements:</h4>
<p>Look at the keyboard interactions required we will need to support the following movements:</p>
<ul>
<li><code>Enter</code> or <code>Space</code> will expand the content (panel) could also close the content</li>
<li><code>Tab</code> Moves focus between Headers</li>
<li><code>Down Arrow</code> (optional) - Moves focus to the next header</li>
<li><code>Up Arrow</code> (optional) - Moves focus to the prev header</li>
<li><code>Home</code> (optional) - Moves focus to the first header</li>
<li><code>End</code> (optional) - Moves focus to the last header</li>
</ul>
<p>We will also need to support the following Aria Properties:</p>
<ul>
<li><code>aria-expanded</code> - toggle true/false depending on the state of the panel (open/closed)</li>
<li><code>aria-labelledby</code> - set on the panel to refer to the button that controls display of the panel</li>
<li><code>role=region</code> - set on the panel to show panel as a container</li>
</ul>
<p>At this point, I would like to bring attention to the fact that W3 doesn’t recommend using <code>aria-hidden</code>. This is somewhat dependent on the implementation of the component and how we are showing/hiding the panels. The following quote is from <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-hidden" rel="nofollow, noopener, noreferrer" target="_blank">MDN</a>, and describes when not to use <code>aria-hidden</code>.</p>
<blockquote>
<p>aria-hidden=“true” should not be added when:</p>
<ul>
<li>The HTML hidden attribute is present</li>
<li>The element or the element’s ancestor is hidden with display: none</li>
<li>The element or the element’s ancestor is hidden with visibility: hidden</li>
</ul>
</blockquote>
<p>You can also view the example directly from the <a href="https://www.w3.org/WAI/ARIA/apg/patterns/accordion/examples/accordion/#sc1_label" rel="nofollow, noopener, noreferrer" target="_blank">W3C</a> and notice the use of the <code>hidden</code> attribute over <code>aria-hidden</code> when using CSS (<code>display:none;</code>) directly to control the visibility.</p>
<h2 id="the-component">The Component</h2>
<p>When building a component, I usually prefer to begin by defining the API that developers would utilize to configure the component. This practice enables me to identify any potential shortcomings early in the development process. For instance, in our accordion component, the presence of multiple sections is essential for accommodating various options. While one approach could entail creating two distinct components, such as AccordionGroup and Accordion, promoting composition over props, it inevitably increases the required understanding and documentation regarding the relationship between the components. However, with Vue and named slots, we can achieve the same objective of composition over props, effectively leveraging both strategies concurrently.</p>
<h4 id="define-props-and-refs">Define Props and Refs</h4>
<p>We will be using the Vue 3 Composition API via the <code>&#x3C;script setup></code> tag for the following code.</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.kq0fl.css"><script type="module" src="/_astro/ec.sgewm.js"><\/script><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#616972;--1:#96A1C2">/**</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   * Structure of our section object.</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   *</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   * </span><span style="--0:#BF3441;--1:#FF79C6">@typedef</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#6F42C1;--1:#8BE9FD;--1fs:italic">{Object}</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#6F42C1;--1:#8BE9FD;--1fs:italic">SectionProps</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   * </span><span style="--0:#BF3441;--1:#FF79C6">@property</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#6F42C1;--1:#8BE9FD;--1fs:italic">{string}</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#24292E;--1:#FFB86C;--1fs:italic">slug</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   * </span><span style="--0:#BF3441;--1:#FF79C6">@property</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#6F42C1;--1:#8BE9FD;--1fs:italic">{string}</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#24292E;--1:#FFB86C;--1fs:italic">heading</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">   * </span><span style="--0:#BF3441;--1:#FF79C6">@property</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#6F42C1;--1:#8BE9FD;--1fs:italic">{string}</span><span style="--0:#616972;--1:#96A1C2"> </span><span style="--0:#24292E;--1:#FFB86C;--1fs:italic">content</span></div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">  */</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">props</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">defineProps</span><span style="--0:#24292E;--1:#F8F8F2">({</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    sections</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> Array, required</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">true</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    headingAs</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String, default</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">h3</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    initialOpen</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  });</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">accordionGroupEl</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">null</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">buttonArray</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">([])</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentFocusedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentExpandedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  /**   * Structure of our section object.   *   * @typedef {Object} SectionProps   * @property {string} slug   * @property {string} heading   * @property {string} content  */  const props = defineProps({    sections: { type: Array, required: true },    headingAs: { type: String, default: &#x27;h3&#x27; },    initialOpen: { type: String },  });  const accordionGroupEl = ref(null)  const buttonArray = ref([])  const currentFocusedIndex = ref(0)  const currentExpandedIndex = ref(-1)"><div></div></button></div></figure></div>
<p>So far we have defined the props our component will use. Lets go over these a bit:</p>
<ul>
<li><strong>sections</strong> - An <code>array</code> of <code>objects</code> which define our accordion sections.</li>
<li><strong>headingAs</strong> - An optional prop that defines the html element used for our heading.</li>
<li><strong>initialOpen</strong> - An optional prop that open a panel on initial rendering.</li>
</ul>
<p>Next lets talk about the reactive properties we defined as these will help us maintain the state of our accordion:</p>
<ul>
<li><strong>accordionGroupEl</strong> - This is a <code>ref</code> link to the root <code>el</code> of our component.</li>
<li><strong>buttonArray</strong> - This will end up being a <code>NodeList</code> of our buttons.</li>
<li><strong>currentFocusedIndex</strong> - Keep track of focus</li>
<li><strong>currentExpandedIndex</strong> - Keep track of what panel is open</li>
</ul>
<h4 id="markup">Markup</h4>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-group</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">ref</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordionGroupEl</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">data-test-id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-group</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">v-for</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">(section, index) in sections</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:key</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;</span><span style="--0:#B31D28;--0fs:italic;--1:#FF7777;--1fs:italic;--1td:underline">component</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-heading</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:is</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">headingAs</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">button</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">type</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">            {{ section.heading }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">button</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;/</span><span style="--0:#B31D28;--0fs:italic;--1:#FF7777;--1fs:italic;--1td:underline">component</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-panel</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-content\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          {{ section.content }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  <div    class=&#x22;accordion-group&#x22;    ref=&#x22;accordionGroupEl&#x22;    data-test-id=&#x22;accordion-group&#x22;  >    <div      class=&#x22;accordion&#x22;      v-for=&#x22;(section, index) in sections&#x22;      :key=&#x22;section.slug&#x22;    >      <component        class=&#x22;accordion-heading&#x22;        :is=&#x22;headingAs&#x22;      >        <button          class=&#x22;accordion-button&#x22;          type=&#x22;button&#x22;          :id=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;        >          <slot :name=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;>            {{ section.heading }}          </slot>        </button>      </component>      <div        class=&#x22;accordion-panel&#x22;        :id=&#x22;section.slug&#x22;      >        <slot :name=&#x22;&#x60;\${section.slug}-content&#x60;&#x22;>          {{ section.content }}        </slot>      </div>    </div>  </div>"><div></div></button></div></figure></div>
<p>The markup is pretty straightforward. We are building the accordion with a parent wrapper <code>accordion-group</code>. We are assigning this a <code>ref</code> so we can access this root level node. We also give this a <code>data-test-id</code> that we will use in our unit tests in Part 2 (Coming Soon).</p>
<p>Next is the use of the <code>component</code> prop. We are using this here so we can change the element for our <code>heading</code>. By default, this will be an <code>h3</code>, but to maintain semantic markup, we might need to use an <code>h2</code>, <code>h4</code>, etc.</p>
<p>In the button and accordion-panel elements, you’ll notice we use named slots with the provided slug. This helps us assemble our component in a flexible way, adhering to the composition over props concept. I appreciate this approach because it offers us options. For instance, if we have simple text sections, we can set them up quickly by just using an array of objects. However, if we need more complicated layouts for each section, we can now utilize these slots. We simply use <code>{slug}-heading</code> or <code>{slug}-content</code> depending on our requirements.</p>
<h4 id="component-logic">Component Logic</h4>
<p>Let’s start writing some of our logic to handle the interactivity of our component. We’ll begin by setting up the <code>onMounted</code> hook.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#6F42C1;--1:#50FA7B">onMounted</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  buttonArray.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> accordionGroupEl.value?.</span><span style="--0:#6F42C1;--1:#50FA7B">querySelectorAll</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">.accordion-button</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(props.initialOpen </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">undefined</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">index</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> props.sections.</span><span style="--0:#6F42C1;--1:#50FA7B">findIndex</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">section</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> section.slug </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> props.initialOpen)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(index </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(index)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="onMounted(() => {  buttonArray.value = accordionGroupEl.value?.querySelectorAll(&#x27;.accordion-button&#x27;)  if(props.initialOpen !== undefined) {    const index = props.sections.findIndex(section => section.slug === props.initialOpen)    if(index !== -1) {      toggleSelectedPanel(index)    }  }});"><div></div></button></div></figure></div>
<p>In the code snippet above, we’re initializing our <code>buttonArray</code> reference to contain all the elements with the class <code>accordion-button</code>. Additionally, we’re checking whether the <code>initialOpen</code> prop is specified. If it is, we search for the index of the provided slug within our sections. If we find the index, we trigger the <code>toggleSelectedPanel</code> method. We’ll delve into setting up this method shortly.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">handleFocusIn</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">event</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#8BE9FD;--1fs:italic">Array</span><span style="--1:#F8F8F2"><span style="--0:#24292E">.</span><span style="--0:#005CC5">prototype</span><span style="--0:#24292E">.indexOf.</span></span><span style="--0:#6F42C1;--1:#50FA7B">call</span><span style="--0:#24292E;--1:#F8F8F2">(buttonArray.value, event.target);</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">}</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">index</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> index </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> index;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">}</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const handleFocusIn = (event) => {  currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);}const toggleSelectedPanel = (index) => {  currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;}"><div></div></button></div></figure></div>
<p>Here, we’re introducing two essential functions to manage the behavior of our accordion component. The <code>handleFocusIn</code> function is responsible for tracking the currently focused button within the component, which we’ll invoke using the <code>@focus</code> event handler. Following that, the <code>toggleSelectedPanel</code> method facilitates the opening and closing of panels accordingly. If the <code>currentExpandedIndex</code> is already set to the provided index, we’ll close the panel by setting <code>currentExpandedIndex</code> to -1. Conversely, if the index differs, we’ll expand the panel by updating <code>currentExpandedIndex</code> to the provided index. These functions are pivotal for ensuring smooth interaction and proper functionality within our accordion component.</p>
<p>Next, we’ll add some computed properties that will help us keep track of the previous and next indexes. We use <code>computed</code> here so that <code>prevIndex</code> and <code>nextIndex</code> are reactive to when we set <code>currentFocusedIndex</code> from the <code>handleFocusIn</code> method.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">nextIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">+</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">prevIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const nextIndex = computed(() => {  return currentFocusedIndex.value === buttonArray.value.length - 1    ? 0    : currentFocusedIndex.value + 1});const prevIndex = computed(() => {  return currentFocusedIndex.value === 0    ? buttonArray.value.length - 1    : currentFocusedIndex.value - 1});"><div></div></button></div></figure></div>
<p>All together now, we should have a component where our <code>&#x3C;script setup></code> looks like this:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">template</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#616972;--1:#96A1C2">&#x3C;!-- ... component markup --></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">template</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">script</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">setup</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">import</span><span style="--0:#24292E;--1:#F8F8F2"> { ref, computed, onMounted } </span><span style="--0:#BF3441;--1:#FF79C6">from</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">vue</span><span style="--0:#032F62;--1:#E9F284">'</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">props</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">defineProps</span><span style="--0:#24292E;--1:#F8F8F2">({</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  sections</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> Array, required</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">true</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  headingAs</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String, default</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">h3</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  initialOpen</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">})</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">accordionGroupEl</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">null</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">buttonArray</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">([]) </span><span style="--0:#616972;--1:#96A1C2">// Nodelist</span></div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentFocusedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentExpandedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">nextIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">+</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">prevIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">handleFocusIn</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">event</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#8BE9FD;--1fs:italic">Array</span><span style="--1:#F8F8F2"><span style="--0:#24292E">.</span><span style="--0:#005CC5">prototype</span><span style="--0:#24292E">.indexOf.</span></span><span style="--0:#6F42C1;--1:#50FA7B">call</span><span style="--0:#24292E;--1:#F8F8F2">(buttonArray.value, event.target);</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">}</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">index</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> index </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> index;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">}</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#6F42C1;--1:#50FA7B">onMounted</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  buttonArray.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> accordionGroupEl.value?.</span><span style="--0:#6F42C1;--1:#50FA7B">querySelectorAll</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">.accordion-button</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(props.initialOpen </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">undefined</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">index</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> props.sections.</span><span style="--0:#6F42C1;--1:#50FA7B">findIndex</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">section</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> section.slug </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> props.initialOpen)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(index </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(index)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">});</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">script</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<template>  <!-- ... component markup --></template><script setup>import { ref, computed, onMounted } from &#x27;vue&#x27;const props = defineProps({  sections: { type: Array, required: true },  headingAs: { type: String, default: &#x27;h3&#x27; },  initialOpen: { type: String },})const accordionGroupEl = ref(null)const buttonArray = ref([]) // Nodelistconst currentFocusedIndex = ref(0)const currentExpandedIndex = ref(-1)const nextIndex = computed(() => {  return currentFocusedIndex.value === buttonArray.value.length - 1    ? 0    : currentFocusedIndex.value + 1});const prevIndex = computed(() => {  return currentFocusedIndex.value === 0    ? buttonArray.value.length - 1    : currentFocusedIndex.value - 1});const handleFocusIn = (event) => {  currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);}const toggleSelectedPanel = (index) => {  currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;}onMounted(() => {  buttonArray.value = accordionGroupEl.value?.querySelectorAll(&#x27;.accordion-button&#x27;)  if(props.initialOpen !== undefined) {    const index = props.sections.findIndex(section => section.slug === props.initialOpen)    if(index !== -1) {      toggleSelectedPanel(index)    }  }});<\/script>"><div></div></button></div></figure></div>
<p>Now that we have some of the logic worked out, let’s update our markup to handle events and visibility of the panels. First, let’s add the <code>@focus</code> and <code>@pointerup</code> events to the <code>button</code> element. Notice that we are using <code>pointerup</code> here to handle both click and touch events; you’ll need to take note of this when we get to writing our unit tests in Part 2. For more information on <code>pointerup</code>, see the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events" rel="nofollow, noopener, noreferrer" target="_blank">MDN docs here</a>.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">button</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">type</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  :</span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`</span><span style="--0:#032F62;--1:#FF79C6">\${</span><span style="--1:#F8F8F2"><span style="--0:#24292E">section</span><span style="--0:#032F62">.</span><span style="--0:#24292E">slug</span></span><span style="--0:#032F62;--1:#FF79C6">}</span><span style="--0:#032F62;--1:#F1FA8C">-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  @</span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">focus</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">handleFocusIn</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  @</span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">pointerup</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#613aa9;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(index)</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;slot :name="\`\${section.slug}-heading\`"></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    {{ section.heading }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/slot></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">button</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<button  class=&#x22;accordion-button&#x22;  type=&#x22;button&#x22;  :id=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;  @focus=&#x22;handleFocusIn&#x22;  @pointerup=&#x22;toggleSelectedPanel(index)&#x22;>  <slot :name=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;>    {{ section.heading }}  </slot></button>"><div></div></button></div></figure></div>
<p>Next lets update our <code>accordion-panel</code> to use v-show:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-panel</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  :</span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">v-show</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">currentExpandedIndex </span><span style="--0:#982934;--1:#ff91d0">===</span><span style="--0:#24292E;--1:#F8F8F2"> index</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;slot :name="\`\${section.slug}-content\`"></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    {{ section.content }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/slot></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<div  class=&#x22;accordion-panel&#x22;  :id=&#x22;section.slug&#x22;  v-show=&#x22;currentExpandedIndex === index&#x22;>  <slot :name=&#x22;&#x60;\${section.slug}-content&#x60;&#x22;>    {{ section.content }}  </slot></div>"><div></div></button></div></figure></div>
<p>By now, your accordion should be working, tracking the focus when tabbing into it, along with showing/hiding the panels when clicking on the buttons.</p>
<h4 id="keyboard-events">Keyboard Events</h4>
<p>So back in the <a href="#a11y-requirements">a11y requirements</a>, we noted which keyboard events we will need to support and what should happen upon triggering these events. Let’s write a method to handle these events:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">handleKeyDown</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">event</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2"> (currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> { </span><span style="--0:#005CC5">code</span><span style="--0:#24292E"> } </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> event;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">switch</span><span style="--0:#24292E;--1:#F8F8F2"> (code) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Home</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      buttonArray.value[</span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">End</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--1:#F8F8F2"><span style="--0:#24292E">      buttonArray.value[buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">ArrowUp</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Up</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      buttonArray.value[prevIndex.value].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">ArrowDown</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Down</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      buttonArray.value[nextIndex.value].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Space</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Enter</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(currentFocusedIndex.value);</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">}</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const handleKeyDown = (event) => {  if (currentFocusedIndex.value === -1) return;  const { code } = event;  switch (code) {    case &#x27;Home&#x27;:      event.preventDefault();      buttonArray.value[0].focus();      currentFocusedIndex.value = 0;    break;    case &#x27;End&#x27;:      event.preventDefault();      buttonArray.value[buttonArray.value.length - 1].focus();      currentFocusedIndex.value = buttonArray.value.length - 1;    break;    case &#x27;ArrowUp&#x27;:    case &#x27;Up&#x27;:      event.preventDefault();      buttonArray.value[prevIndex.value].focus();    break;    case &#x27;ArrowDown&#x27;:    case &#x27;Down&#x27;:      event.preventDefault();      buttonArray.value[nextIndex.value].focus();    break;    case &#x27;Space&#x27;:    case &#x27;Enter&#x27;:      event.preventDefault();      toggleSelectedPanel(currentFocusedIndex.value);  }}"><div></div></button></div></figure></div>
<p>Our <code>handleKeyUp</code> method will be responsible for handling all our keyboard events. First, we check to see if a button is currently focused within the accordion. If there isn’t a focused button, we exit early. Next, we destructure the <code>code</code> from the <code>event</code>, in which our <code>switch</code> will handle the cases of which key was pressed. All of the following keys <code>Home</code>, <code>End</code>, <code>ArrowUp</code>, and <code>ArrowDown</code> adjust which button is focused in the accordion. The <code>Space</code> and <code>Enter</code> keys will trigger our <code>toggleSelectedPanel</code> method.</p>
<p>Additionally, the function prevents the default actions for each key event. You might think we should move the <code>event.preventDefault()</code> to the root of the method or perhaps use <code>.prevent</code> on the event handler defined on the HTML element, but by doing either of these, we would break the behavior of the <code>Tab</code> and possibly other keys. This way, we only prevent the default action for the keys we are looking for.</p>
<p>So now let’s update our component markup to bind to the keyboard events:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">button</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">type</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  :</span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`</span><span style="--0:#032F62;--1:#FF79C6">\${</span><span style="--1:#F8F8F2"><span style="--0:#24292E">section</span><span style="--0:#032F62">.</span><span style="--0:#24292E">slug</span></span><span style="--0:#032F62;--1:#FF79C6">}</span><span style="--0:#032F62;--1:#F1FA8C">-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  @</span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">keydown</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">handleKeyDown</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  @</span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">focus</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">handleFocusIn</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  @</span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">pointerup</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(index)</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;slot :name="\`\${section.slug}-heading\`"></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    {{ section.heading }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/slot></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">button</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<button  class=&#x22;accordion-button&#x22;  type=&#x22;button&#x22;  :id=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;  @keydown=&#x22;handleKeyDown&#x22;  @focus=&#x22;handleFocusIn&#x22;  @pointerup=&#x22;toggleSelectedPanel(index)&#x22;>  <slot :name=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;>    {{ section.heading }}  </slot></button>"><div></div></button></div></figure></div>
<p>I’ve opted to use <code>keydown</code> rather than <code>keyup</code> in this scenario. The rationale behind this choice is to prevent inadvertent scrolling of the page when the <code>Home</code> or <code>End</code> keys are pressed. If we were to bind to <code>keyup</code>, pressing <code>Home</code> or <code>End</code> would trigger page scrolling, potentially shifting the accordion out of view while maintaining focus. By using <code>keydown</code>, we intercept these key events before the default action (scrolling) occurs, ensuring that the accordion remains in view and focused, thereby enhancing the user experience.</p>
<p>By now we should have a fairly complete component, lets review the full markup to this point:</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">TheAccordion.vue</span></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">template</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-group</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">ref</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordionGroupEl</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">data-test-id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-group</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">v-for</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">(section, index) in sections</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:key</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;</span><span style="--0:#B31D28;--0fs:italic;--1:#FF7777;--1fs:italic;--1td:underline">component</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-heading</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:is</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">headingAs</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">button</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">type</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@keydown</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">handleKeyDown</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@focus</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">handleFocusIn</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@pointerup</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">toggleSelectedPanel(index)</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">            {{ section.heading }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">button</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;/</span><span style="--0:#B31D28;--0fs:italic;--1:#FF7777;--1fs:italic;--1td:underline">component</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-panel</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">v-show</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">currentExpandedIndex === index</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      ></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-content\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">          {{ section.content }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">template</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">script</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">setup</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">import</span><span style="--0:#24292E;--1:#F8F8F2"> { ref, computed, onMounted } </span><span style="--0:#BF3441;--1:#FF79C6">from</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">vue</span><span style="--0:#032F62;--1:#E9F284">'</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">props</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">defineProps</span><span style="--0:#24292E;--1:#F8F8F2">({</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    sections</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> Array, required</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">true</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    headingAs</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String, default</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">h3</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2"> },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    initialOpen</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> { type</span><span style="--0:#24292E;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> String },</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  })</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">accordionGroupEl</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">null</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">buttonArray</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">([])</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentFocusedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">currentExpandedIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">ref</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">nextIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">+</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  });</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">prevIndex</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">computed</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  });</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">handleFocusIn</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">event</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#8BE9FD;--1fs:italic">Array</span><span style="--1:#F8F8F2"><span style="--0:#24292E">.</span><span style="--0:#005CC5">prototype</span><span style="--0:#24292E">.indexOf.</span></span><span style="--0:#6F42C1;--1:#50FA7B">call</span><span style="--0:#24292E;--1:#F8F8F2">(buttonArray.value, event.target);</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">index</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> currentExpandedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> index </span><span style="--0:#BF3441;--1:#FF79C6">?</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">:</span><span style="--0:#24292E;--1:#F8F8F2"> index;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B">handleKeyDown</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> (</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">event</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2"> (currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">) </span><span style="--0:#BF3441;--1:#FF79C6">return</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> { </span><span style="--0:#005CC5">code</span><span style="--0:#24292E"> } </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> event;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">switch</span><span style="--0:#24292E;--1:#F8F8F2"> (code) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Home</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        buttonArray.value[</span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">0</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">End</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--1:#F8F8F2"><span style="--0:#24292E">        buttonArray.value[buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        currentFocusedIndex.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> buttonArray.value.</span><span style="--0:#005CC5">length</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">ArrowUp</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Up</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        buttonArray.value[prevIndex.value].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">ArrowDown</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Down</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        buttonArray.value[nextIndex.value].</span><span style="--0:#6F42C1;--1:#50FA7B">focus</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">break</span><span style="--0:#24292E;--1:#F8F8F2">;</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Space</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">case</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">Enter</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">:</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        event.</span><span style="--0:#6F42C1;--1:#50FA7B">preventDefault</span><span style="--0:#24292E;--1:#F8F8F2">();</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(currentFocusedIndex.value);</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B">onMounted</span><span style="--0:#24292E;--1:#F8F8F2">(() </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    buttonArray.value </span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> accordionGroupEl.value?.</span><span style="--0:#6F42C1;--1:#50FA7B">querySelectorAll</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#032F62;--1:#F1FA8C">.accordion-button</span><span style="--0:#032F62;--1:#E9F284">'</span><span style="--0:#24292E;--1:#F8F8F2">)</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(props.initialOpen </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#005CC5;--1:#BD93F9">undefined</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">const</span><span style="--1:#F8F8F2"><span style="--0:#24292E"> </span><span style="--0:#005CC5">index</span><span style="--0:#24292E"> </span></span><span style="--0:#BF3441;--1:#FF79C6">=</span><span style="--0:#24292E;--1:#F8F8F2"> props.sections.</span><span style="--0:#6F42C1;--1:#50FA7B">findIndex</span><span style="--0:#24292E;--1:#F8F8F2">(</span><span style="--0:#AE4B07;--1:#FFB86C;--1fs:italic">section</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">=></span><span style="--0:#24292E;--1:#F8F8F2"> section.slug </span><span style="--0:#BF3441;--1:#FF79C6">===</span><span style="--0:#24292E;--1:#F8F8F2"> props.initialOpen)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      </span><span style="--0:#BF3441;--1:#FF79C6">if</span><span style="--0:#24292E;--1:#F8F8F2">(index </span><span style="--0:#BF3441;--1:#FF79C6">!==</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#BF3441;--1:#FF79C6">-</span><span style="--0:#005CC5;--1:#BD93F9">1</span><span style="--0:#24292E;--1:#F8F8F2">) {</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">        </span><span style="--0:#6F42C1;--1:#50FA7B">toggleSelectedPanel</span><span style="--0:#24292E;--1:#F8F8F2">(index)</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">      }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    }</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  });</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">script</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<template>  <div    class=&#x22;accordion-group&#x22;    ref=&#x22;accordionGroupEl&#x22;    data-test-id=&#x22;accordion-group&#x22;  >    <div      class=&#x22;accordion&#x22;      v-for=&#x22;(section, index) in sections&#x22;      :key=&#x22;section.slug&#x22;    >      <component        class=&#x22;accordion-heading&#x22;        :is=&#x22;headingAs&#x22;      >        <button          class=&#x22;accordion-button&#x22;          type=&#x22;button&#x22;          :id=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;          @keydown=&#x22;handleKeyDown&#x22;          @focus=&#x22;handleFocusIn&#x22;          @pointerup=&#x22;toggleSelectedPanel(index)&#x22;        >          <slot :name=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;>            {{ section.heading }}          </slot>        </button>      </component>      <div        class=&#x22;accordion-panel&#x22;        :id=&#x22;section.slug&#x22;        v-show=&#x22;currentExpandedIndex === index&#x22;      >        <slot :name=&#x22;&#x60;\${section.slug}-content&#x60;&#x22;>          {{ section.content }}        </slot>      </div>    </div>  </div></template><script setup>  import { ref, computed, onMounted } from &#x27;vue&#x27;  const props = defineProps({    sections: { type: Array, required: true },    headingAs: { type: String, default: &#x27;h3&#x27; },    initialOpen: { type: String },  })  const accordionGroupEl = ref(null)  const buttonArray = ref([])  const currentFocusedIndex = ref(0)  const currentExpandedIndex = ref(-1)  const nextIndex = computed(() => {    return currentFocusedIndex.value === buttonArray.value.length - 1      ? 0      : currentFocusedIndex.value + 1  });  const prevIndex = computed(() => {    return currentFocusedIndex.value === 0      ? buttonArray.value.length - 1      : currentFocusedIndex.value - 1  });  const handleFocusIn = (event) => {    currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);  }  const toggleSelectedPanel = (index) => {    currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;  }  const handleKeyDown = (event) => {    if (currentFocusedIndex.value === -1) return;    const { code } = event;    switch (code) {      case &#x27;Home&#x27;:        event.preventDefault();        buttonArray.value[0].focus();        currentFocusedIndex.value = 0;      break;      case &#x27;End&#x27;:        event.preventDefault();        buttonArray.value[buttonArray.value.length - 1].focus();        currentFocusedIndex.value = buttonArray.value.length - 1;      break;      case &#x27;ArrowUp&#x27;:      case &#x27;Up&#x27;:        event.preventDefault();        buttonArray.value[prevIndex.value].focus();      break;      case &#x27;ArrowDown&#x27;:      case &#x27;Down&#x27;:        event.preventDefault();        buttonArray.value[nextIndex.value].focus();      break;      case &#x27;Space&#x27;:      case &#x27;Enter&#x27;:        event.preventDefault();        toggleSelectedPanel(currentFocusedIndex.value);    }  }  onMounted(() => {    buttonArray.value = accordionGroupEl.value?.querySelectorAll(&#x27;.accordion-button&#x27;)    if(props.initialOpen !== undefined) {      const index = props.sections.findIndex(section => section.slug === props.initialOpen)      if(index !== -1) {        toggleSelectedPanel(index)      }    }  });<\/script>"><div></div></button></div></figure></div>
<h4 id="aria-support">Aria Support</h4>
<p>Finally, we need to add the appropriate ARIA attributes to our HTML elements. For detailed information about which attributes we’ll be adding and their significance, please refer to the <a href="#a11y-requirements">a11y requirements</a> section. These ARIA attributes play a crucial role in ensuring accessibility for users who rely on assistive technologies, enhancing their understanding and navigation of the accordion component.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2"> &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">button</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">type</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">button</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">:aria-expanded</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">currentExpandedIndex === index</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">:aria-controls</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@keydown</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">handleKeyUp</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@focus</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">handleFocusIn</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">@pointerup</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">toggleSelectedPanel(index)</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    {{ section.heading }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">button</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#616972;--1:#96A1C2">&#x3C;!-- other markup --></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">div</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">class</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">accordion-panel</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">role</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">region</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">:aria-labelledby</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-heading\`</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line ins"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#613aa9;--1:#50FA7B;--1fs:italic">:hidden</span><span style="--0:#24292E;--1:#ff91d0">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">currentExpandedIndex !== index</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:id</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">section.slug</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">v-show</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">currentExpandedIndex === index</span><span style="--0:#032F62;--1:#E9F284">"</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2"> </span><span style="--0:#6F42C1;--1:#50FA7B;--1fs:italic">:name</span><span style="--0:#24292E;--1:#FF79C6">=</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#032F62;--1:#F1FA8C">\`\${section.slug}-content\`</span><span style="--0:#032F62;--1:#E9F284">"</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">    {{ section.content }}</span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">  &#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">slot</span><span style="--0:#24292E;--1:#F8F8F2">></span></div><div class="ec-line"><span style="--0:#24292E;--1:#F8F8F2">&#x3C;/</span><span style="--0:#1E7734;--1:#FF79C6">div</span><span style="--0:#24292E;--1:#F8F8F2">></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" <button  class=&#x22;accordion-button&#x22;  type=&#x22;button&#x22;  :id=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;  :aria-expanded=&#x22;currentExpandedIndex === index&#x22;  :aria-controls=&#x22;section.slug&#x22;  @keydown=&#x22;handleKeyUp&#x22;  @focus=&#x22;handleFocusIn&#x22;  @pointerup=&#x22;toggleSelectedPanel(index)&#x22;>  <slot :name=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;>    {{ section.heading }}  </slot></button><!-- other markup --><div  class=&#x22;accordion-panel&#x22;  role=&#x22;region&#x22;  :aria-labelledby=&#x22;&#x60;\${section.slug}-heading&#x60;&#x22;  :hidden=&#x22;currentExpandedIndex !== index&#x22;  :id=&#x22;section.slug&#x22;  v-show=&#x22;currentExpandedIndex === index&#x22;>  <slot :name=&#x22;&#x60;\${section.slug}-content&#x60;&#x22;>    {{ section.content }}  </slot></div>"><div></div></button></div></figure></div>
<h2 id="conclusion">Conclusion</h2>
<p>To wrap up, we’ve covered the process of creating an accessible-friendly accordion component using Vue 3. By following best practices for accessibility, we ensure that our component is not only functional but also inclusive and reliable for all users.
In Part 2, we will cover writing unit tests for the accordion component. You can find <a href="/posts/adding-unit-tests-to-our-accordion/">part 2 here</a>.</p>
<p><a href="https://play.vuejs.org/#eNqtWH1P20YY/yo3d1qCljhQVmlLk7asZSubVtCgfxGkGvsSu1x87vkcQCjffc9zbz4njgWsqFLse95+97y7D8FRUYSrigbjYFLGIiskKamsijeznJBsWXAhyUVKj+KYiyTjOZkLviS9cOQfooLe61mOMjHPS9QRSyCUZEou8ZSQB/1DSMmqxZj0DMfwoDewlJRGSZYj8VwTiUcEvZLmEojv9ROZc2HtAKPmWxv+XdZedlnziN3WXj7S2mGXNY/Ybe3QWsOfK3DzZKQjBTGCF0mXBYskVRGDqJA6Vh/okuPppBFBrW1sQzSdBfZxFiBtpDRNUmGeTvJMZhEjpwXNafJ0fUDLtArU4JEvD65C9Fi72Y+HpCppolxhvPcc20b0CGnpYbupc8Zl+XTlShaEbATIC5fUQ2PWsECKPLiauNy/Cg2ZrFVQ8e+nF7+++u3Va2N0MmqEdYcRkzfOyEWalQT+Le9JXJUSCtVwEJlGEih5T5KEzjOIY2iFJtlyQUoRo3+kLMajEdiJ6TDlLAkzOTp4tT8LjKO2gE0afQCOGvRgEMgSIMyzRfi15Dk0GVUqsyDmyyJjVJwWxp9jW0SzIGKM3/6lzqSoqKkSkElpfNNy/rW8w7NZcCZoScWKzgJHk5FYUKnJx+ef6B08O+KSJxUD7g7iv7TkrEKMmu33Kk8Atsen0J6oRgkBvSiP78Dhpb0UAkVO3SlmATTK9x1Xr+Eehr8ouVm+Bi9uNlvs1s04JNnKpE7MohJzNbICw4XgVWHrQdC5T/wTacfMUpNIRkNJSznMkl06bCbUJluMWoWErIZQwUDqm7wdkCxP6N0e/LiSqLnHN/S+LjSvPTi7YBmzh+eQ1/ak7da2ZzjV2IdUF7AdoSY51aD8upLSFf8u5ZrJ102IvC8oMLWRxsqbX3588O+1thC/bDBHIouG9K6IwE8oF1dCwGWPzckJuo9Mp1PtyDZhLHvBmdeyGp7Uf+/A1Qm/xY6cgmJG/6b3n12eGJ45h07iOP7At5ONy70reAZdRlQF8Em+WDB6ThmYpclZlFPW1/H2hTx/g8dLaL9knEdLdF+HkxpSfkttaae6V6FmP7YjHZw6k0YuldQwNad+ZrdFH+JAXcmoouIMsQu6aKS+DQeLriljNLnG1H5UFozTLEnUsGwN/g918D2gOst2BXw1LFN++4R08h3XHSIzZTZD5AXIziE/QBvhmYzA7W7K2Gf71Jgr8LprV33ABjeAubcsKkjAAeH5P7wC4wlZm90Vl1V/Vy0EL3BR1YPxDN/6piPb/gQtWpX3mBwJEd0PwMi3KhM00R3eLYKutdQC51LAyQC1RxXDHS897DkBbzHaFDE86z0f62bfBthw335eMQZ8lktnuYJqGC6v9shoRD7xhLKsVH1Ts5pkUIXtckGJ7HsK21NGsQ0PGgBzmKKWbIPQ7++R6Rs75QSETORthsNVxMCZmIreDfRpyGi+kCkZkgObMG/JvpsaHep+1hLrvcYHSiHo6jvgdAjePgpyF07DtoGz0XcBa5+uQNzH2QFQZ2sICS45plaoKvx0HsawtfS3AA+IUh7qLQRxqAWkBtPS3BGSmedbkBrp4jB1EW0TAncOD8Bb6mUbhzeuWl2SzUm/O26QtSbAxttW9QP8JlDQoFepdeTyNpNxCnqBvFd/8cVRSUnvI1/S3rhubdqPmGPw+0FXfl87VP9t+R4/CtSsbbB1xXbf8V0LGt24N43oOE/+J6CufH4q1i5dndcAEX77uaivoo/9k2ddzpW/ft++z04wH2Bj2oTTPHsWINc3nwLovIAPtU0wx7iLPQlN2862M5pWUA1yU5VuxjY76NYtIRM2B5gmvA2/VVTcawhcHEF36oWb23bPDBqs774a2tDP3PhUOxF8nemvW79CVV3rtjLVwz60cz0EZn05+3WC8P3lRnWLLWNqNBokWjNax6bizLa71azChscsQ9qV6Fjvf3aC9X94Bk03" rel="nofollow, noopener, noreferrer" target="_blank">View Demo on Vue SFC Playground</a></p>
<p><a href="https://github.com/utroda/the-accordion" rel="nofollow, noopener, noreferrer" target="_blank">View Repo With Source</a></p>`,F={title:"Building an accessible accordian component with Vue (Part 1)",description:"Let's build an accessible accordian componet with Vue.js and meet the spec for W3C.",publishDate:"27 Feb 2024",tags:["Vue","Accessiblity","Component"],minutesRead:"12 min read"},l="/Users/utroda/github/personal-site/src/content/post/building-an-accessible-accordion-component-vue.md",i=void 0;function E(){return`Accordions are a common UI pattern used to manage content in a collapsible and expandable manner. They are especially useful when dealing with a large amount of information that needs to be organized and presented in a structured way. However, when implementing accordions, it's crucial to ensure accessibility for all users, including those who rely on assistive technologies like screen readers or keyboard navigation. In this blog post, we'll walk through the process of creating an accessible-friendly accordion component using Vue 3, along with writing unit tests to verify its functionality in Part 2.

## Gather Requirements

Before we begin, it's essential to gather some information about the accessibility (a11y) requirements for an Accordion component. Fortunately, [w3.org](https://www.w3.org/WAI/ARIA/apg/patterns/accordion/) provides valuable insights for us. After reviewing the Accordion Pattern guidelines, we can summarize the following key points:

#### Accordions have two primary sections
- **Accordion Header:** Label for or thumbnail representing a section of content that also serves as a control for showing, and in some implementations, hiding the section of content.
- **Accordion Panel:** Section of content associated with an accordion header.

#### A11y Requirements:

Look at the keyboard interactions required we will need to support the following movements:

- \`Enter\` or \`Space\` will expand the content (panel) could also close the content
- \`Tab\` Moves focus between Headers
- \`Down Arrow\` (optional) - Moves focus to the next header
- \`Up Arrow\` (optional) - Moves focus to the prev header
- \`Home\` (optional) - Moves focus to the first header
- \`End\` (optional) - Moves focus to the last header

We will also need to support the following Aria Properties:

- \`aria-expanded\` - toggle true/false depending on the state of the panel (open/closed)
- \`aria-labelledby\` - set on the panel to refer to the button that controls display of the panel
- \`role=region\` - set on the panel to show panel as a container

At this point, I would like to bring attention to the fact that W3 doesn't recommend using \`aria-hidden\`. This is somewhat dependent on the implementation of the component and how we are showing/hiding the panels. The following quote is from [MDN](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-hidden), and describes when not to use \`aria-hidden\`.

> aria-hidden="true" should not be added when:
> - The HTML hidden attribute is present
> - The element or the element's ancestor is hidden with display: none
> - The element or the element's ancestor is hidden with visibility: hidden

You can also view the example directly from the [W3C](https://www.w3.org/WAI/ARIA/apg/patterns/accordion/examples/accordion/#sc1_label) and notice the use of the \`hidden\` attribute over \`aria-hidden\` when using CSS (\`display:none;\`) directly to control the visibility.

## The Component

When building a component, I usually prefer to begin by defining the API that developers would utilize to configure the component. This practice enables me to identify any potential shortcomings early in the development process. For instance, in our accordion component, the presence of multiple sections is essential for accommodating various options. While one approach could entail creating two distinct components, such as AccordionGroup and Accordion, promoting composition over props, it inevitably increases the required understanding and documentation regarding the relationship between the components. However, with Vue and named slots, we can achieve the same objective of composition over props, effectively leveraging both strategies concurrently.

#### Define Props and Refs

We will be using the Vue 3 Composition API via the \`<script setup>\` tag for the following code.

\`\`\`js
  /**
   * Structure of our section object.
   *
   * @typedef {Object} SectionProps
   * @property {string} slug
   * @property {string} heading
   * @property {string} content
  */

  const props = defineProps({
    sections: { type: Array, required: true },
    headingAs: { type: String, default: 'h3' },
    initialOpen: { type: String },
  });

  const accordionGroupEl = ref(null)
  const buttonArray = ref([])
  const currentFocusedIndex = ref(0)
  const currentExpandedIndex = ref(-1)
\`\`\`

So far we have defined the props our component will use. Lets go over these a bit:

- **sections** - An \`array\` of \`objects\` which define our accordion sections.
- **headingAs** - An optional prop that defines the html element used for our heading.
- **initialOpen** - An optional prop that open a panel on initial rendering.

Next lets talk about the reactive properties we defined as these will help us maintain the state of our accordion:

- **accordionGroupEl** - This is a \`ref\` link to the root \`el\` of our component.
- **buttonArray** - This will end up being a \`NodeList\` of our buttons.
- **currentFocusedIndex** - Keep track of focus
- **currentExpandedIndex** - Keep track of what panel is open

#### Markup

\`\`\`html
  <div
    class="accordion-group"
    ref="accordionGroupEl"
    data-test-id="accordion-group"
  >
    <div
      class="accordion"
      v-for="(section, index) in sections"
      :key="section.slug"
    >
      <component
        class="accordion-heading"
        :is="headingAs"
      >
        <button
          class="accordion-button"
          type="button"
          :id="\`\${section.slug}-heading\`"
        >
          <slot :name="\`\${section.slug}-heading\`">
            {{ section.heading }}
          </slot>
        </button>
      </component>

      <div
        class="accordion-panel"
        :id="section.slug"
      >
        <slot :name="\`\${section.slug}-content\`">
          {{ section.content }}
        </slot>
      </div>
    </div>
  </div>
\`\`\`
The markup is pretty straightforward. We are building the accordion with a parent wrapper \`accordion-group\`. We are assigning this a \`ref\` so we can access this root level node. We also give this a \`data-test-id\` that we will use in our unit tests in Part 2 (Coming Soon).

Next is the use of the \`component\` prop. We are using this here so we can change the element for our \`heading\`. By default, this will be an \`h3\`, but to maintain semantic markup, we might need to use an \`h2\`, \`h4\`, etc.

In the button and accordion-panel elements, you'll notice we use named slots with the provided slug. This helps us assemble our component in a flexible way, adhering to the composition over props concept. I appreciate this approach because it offers us options. For instance, if we have simple text sections, we can set them up quickly by just using an array of objects. However, if we need more complicated layouts for each section, we can now utilize these slots. We simply use \`{slug}-heading\` or \`{slug}-content\` depending on our requirements.

#### Component Logic

Let's start writing some of our logic to handle the interactivity of our component. We'll begin by setting up the \`onMounted\` hook.

\`\`\`js
onMounted(() => {
  buttonArray.value = accordionGroupEl.value?.querySelectorAll('.accordion-button')

  if(props.initialOpen !== undefined) {
    const index = props.sections.findIndex(section => section.slug === props.initialOpen)
    if(index !== -1) {
      toggleSelectedPanel(index)
    }
  }
});
\`\`\`
In the code snippet above, we're initializing our \`buttonArray\` reference to contain all the elements with the class \`accordion-button\`. Additionally, we're checking whether the \`initialOpen\` prop is specified. If it is, we search for the index of the provided slug within our sections. If we find the index, we trigger the \`toggleSelectedPanel\` method. We'll delve into setting up this method shortly.

\`\`\`js
const handleFocusIn = (event) => {
  currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);
}

const toggleSelectedPanel = (index) => {
  currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;
}
\`\`\`
Here, we're introducing two essential functions to manage the behavior of our accordion component. The \`handleFocusIn\` function is responsible for tracking the currently focused button within the component, which we'll invoke using the \`@focus\` event handler. Following that, the \`toggleSelectedPanel\` method facilitates the opening and closing of panels accordingly. If the \`currentExpandedIndex\` is already set to the provided index, we'll close the panel by setting \`currentExpandedIndex\` to -1. Conversely, if the index differs, we'll expand the panel by updating \`currentExpandedIndex\` to the provided index. These functions are pivotal for ensuring smooth interaction and proper functionality within our accordion component.

Next, we'll add some computed properties that will help us keep track of the previous and next indexes. We use \`computed\` here so that \`prevIndex\` and \`nextIndex\` are reactive to when we set \`currentFocusedIndex\` from the \`handleFocusIn\` method.

\`\`\`js
const nextIndex = computed(() => {
  return currentFocusedIndex.value === buttonArray.value.length - 1
    ? 0
    : currentFocusedIndex.value + 1
});

const prevIndex = computed(() => {
  return currentFocusedIndex.value === 0
    ? buttonArray.value.length - 1
    : currentFocusedIndex.value - 1
});
\`\`\`
All together now, we should have a component where our \`<script setup>\` looks like this:

\`\`\`vue
<template>
  <!-- ... component markup -->
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'

const props = defineProps({
  sections: { type: Array, required: true },
  headingAs: { type: String, default: 'h3' },
  initialOpen: { type: String },
})

const accordionGroupEl = ref(null)
const buttonArray = ref([]) // Nodelist
const currentFocusedIndex = ref(0)
const currentExpandedIndex = ref(-1)

const nextIndex = computed(() => {
  return currentFocusedIndex.value === buttonArray.value.length - 1
    ? 0
    : currentFocusedIndex.value + 1
});

const prevIndex = computed(() => {
  return currentFocusedIndex.value === 0
    ? buttonArray.value.length - 1
    : currentFocusedIndex.value - 1
});

const handleFocusIn = (event) => {
  currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);
}

const toggleSelectedPanel = (index) => {
  currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;
}

onMounted(() => {
  buttonArray.value = accordionGroupEl.value?.querySelectorAll('.accordion-button')

  if(props.initialOpen !== undefined) {
    const index = props.sections.findIndex(section => section.slug === props.initialOpen)
    if(index !== -1) {
      toggleSelectedPanel(index)
    }
  }
});
<\/script>
\`\`\`

Now that we have some of the logic worked out, let's update our markup to handle events and visibility of the panels. First, let's add the \`@focus\` and \`@pointerup\` events to the \`button\` element. Notice that we are using \`pointerup\` here to handle both click and touch events; you'll need to take note of this when we get to writing our unit tests in Part 2. For more information on \`pointerup\`, see the [MDN docs here](https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events).

\`\`\`vue ins={5-6}
<button
  class="accordion-button"
  type="button"
  :id="\`\${section.slug}-heading\`"
  @focus="handleFocusIn"
  @pointerup="toggleSelectedPanel(index)"
>
  <slot :name="\`\${section.slug}-heading\`">
    {{ section.heading }}
  </slot>
</button>
\`\`\`

Next lets update our \`accordion-panel\` to use v-show:

\`\`\`vue ins={4}
<div
  class="accordion-panel"
  :id="section.slug"
  v-show="currentExpandedIndex === index"
>
  <slot :name="\`\${section.slug}-content\`">
    {{ section.content }}
  </slot>
</div>
\`\`\`

By now, your accordion should be working, tracking the focus when tabbing into it, along with showing/hiding the panels when clicking on the buttons.

#### Keyboard Events

So back in the [a11y requirements](#a11y-requirements), we noted which keyboard events we will need to support and what should happen upon triggering these events. Let's write a method to handle these events:

\`\`\`js
const handleKeyDown = (event) => {
  if (currentFocusedIndex.value === -1) return;

  const { code } = event;

  switch (code) {
    case 'Home':
      event.preventDefault();
      buttonArray.value[0].focus();
      currentFocusedIndex.value = 0;
    break;
    case 'End':
      event.preventDefault();
      buttonArray.value[buttonArray.value.length - 1].focus();
      currentFocusedIndex.value = buttonArray.value.length - 1;
    break;
    case 'ArrowUp':
    case 'Up':
      event.preventDefault();
      buttonArray.value[prevIndex.value].focus();
    break;
    case 'ArrowDown':
    case 'Down':
      event.preventDefault();
      buttonArray.value[nextIndex.value].focus();
    break;
    case 'Space':
    case 'Enter':
      event.preventDefault();
      toggleSelectedPanel(currentFocusedIndex.value);
  }
}
\`\`\`

Our \`handleKeyUp\` method will be responsible for handling all our keyboard events. First, we check to see if a button is currently focused within the accordion. If there isn't a focused button, we exit early. Next, we destructure the \`code\` from the \`event\`, in which our \`switch\` will handle the cases of which key was pressed. All of the following keys \`Home\`, \`End\`, \`ArrowUp\`, and \`ArrowDown\` adjust which button is focused in the accordion. The \`Space\` and \`Enter\` keys will trigger our \`toggleSelectedPanel\` method.

Additionally, the function prevents the default actions for each key event. You might think we should move the \`event.preventDefault()\` to the root of the method or perhaps use \`.prevent\` on the event handler defined on the HTML element, but by doing either of these, we would break the behavior of the \`Tab\` and possibly other keys. This way, we only prevent the default action for the keys we are looking for.

So now let's update our component markup to bind to the keyboard events:

\`\`\`vue ins={5}
<button
  class="accordion-button"
  type="button"
  :id="\`\${section.slug}-heading\`"
  @keydown="handleKeyDown"
  @focus="handleFocusIn"
  @pointerup="toggleSelectedPanel(index)"
>
  <slot :name="\`\${section.slug}-heading\`">
    {{ section.heading }}
  </slot>
</button>
\`\`\`

I've opted to use \`keydown\` rather than \`keyup\` in this scenario. The rationale behind this choice is to prevent inadvertent scrolling of the page when the \`Home\` or \`End\` keys are pressed. If we were to bind to \`keyup\`, pressing \`Home\` or \`End\` would trigger page scrolling, potentially shifting the accordion out of view while maintaining focus. By using \`keydown\`, we intercept these key events before the default action (scrolling) occurs, ensuring that the accordion remains in view and focused, thereby enhancing the user experience.

By now we should have a fairly complete component, lets review the full markup to this point:

\`\`\`vue title="TheAccordion.vue"
<template>
  <div
    class="accordion-group"
    ref="accordionGroupEl"
    data-test-id="accordion-group"
  >
    <div
      class="accordion"
      v-for="(section, index) in sections"
      :key="section.slug"
    >
      <component
        class="accordion-heading"
        :is="headingAs"
      >
        <button
          class="accordion-button"
          type="button"
          :id="\`\${section.slug}-heading\`"
          @keydown="handleKeyDown"
          @focus="handleFocusIn"
          @pointerup="toggleSelectedPanel(index)"
        >
          <slot :name="\`\${section.slug}-heading\`">
            {{ section.heading }}
          </slot>
        </button>
      </component>

      <div
        class="accordion-panel"
        :id="section.slug"
        v-show="currentExpandedIndex === index"
      >
        <slot :name="\`\${section.slug}-content\`">
          {{ section.content }}
        </slot>
      </div>
    </div>
  </div>
</template>

<script setup>
  import { ref, computed, onMounted } from 'vue'

  const props = defineProps({
    sections: { type: Array, required: true },
    headingAs: { type: String, default: 'h3' },
    initialOpen: { type: String },
  })

  const accordionGroupEl = ref(null)
  const buttonArray = ref([])
  const currentFocusedIndex = ref(0)
  const currentExpandedIndex = ref(-1)

  const nextIndex = computed(() => {
    return currentFocusedIndex.value === buttonArray.value.length - 1
      ? 0
      : currentFocusedIndex.value + 1
  });

  const prevIndex = computed(() => {
    return currentFocusedIndex.value === 0
      ? buttonArray.value.length - 1
      : currentFocusedIndex.value - 1
  });

  const handleFocusIn = (event) => {
    currentFocusedIndex.value = Array.prototype.indexOf.call(buttonArray.value, event.target);
  }

  const toggleSelectedPanel = (index) => {
    currentExpandedIndex.value = currentExpandedIndex.value === index ? -1 : index;
  }

  const handleKeyDown = (event) => {
    if (currentFocusedIndex.value === -1) return;

    const { code } = event;

    switch (code) {
      case 'Home':
        event.preventDefault();
        buttonArray.value[0].focus();
        currentFocusedIndex.value = 0;
      break;
      case 'End':
        event.preventDefault();
        buttonArray.value[buttonArray.value.length - 1].focus();
        currentFocusedIndex.value = buttonArray.value.length - 1;
      break;
      case 'ArrowUp':
      case 'Up':
        event.preventDefault();
        buttonArray.value[prevIndex.value].focus();
      break;
      case 'ArrowDown':
      case 'Down':
        event.preventDefault();
        buttonArray.value[nextIndex.value].focus();
      break;
      case 'Space':
      case 'Enter':
        event.preventDefault();
        toggleSelectedPanel(currentFocusedIndex.value);
    }
  }

  onMounted(() => {
    buttonArray.value = accordionGroupEl.value?.querySelectorAll('.accordion-button')

    if(props.initialOpen !== undefined) {
      const index = props.sections.findIndex(section => section.slug === props.initialOpen)
      if(index !== -1) {
        toggleSelectedPanel(index)
      }
    }
  });
<\/script>
\`\`\`

#### Aria Support

Finally, we need to add the appropriate ARIA attributes to our HTML elements. For detailed information about which attributes we'll be adding and their significance, please refer to the [a11y requirements](#a11y-requirements) section. These ARIA attributes play a crucial role in ensuring accessibility for users who rely on assistive technologies, enhancing their understanding and navigation of the accordion component.

\`\`\`html ins={5-6} ins={20-22}
 <button
  class="accordion-button"
  type="button"
  :id="\`\${section.slug}-heading\`"
  :aria-expanded="currentExpandedIndex === index"
  :aria-controls="section.slug"
  @keydown="handleKeyUp"
  @focus="handleFocusIn"
  @pointerup="toggleSelectedPanel(index)"
>
  <slot :name="\`\${section.slug}-heading\`">
    {{ section.heading }}
  </slot>
</button>

<!-- other markup -->

<div
  class="accordion-panel"
  role="region"
  :aria-labelledby="\`\${section.slug}-heading\`"
  :hidden="currentExpandedIndex !== index"
  :id="section.slug"
  v-show="currentExpandedIndex === index"
>
  <slot :name="\`\${section.slug}-content\`">
    {{ section.content }}
  </slot>
</div>
\`\`\`

## Conclusion

To wrap up, we've covered the process of creating an accessible-friendly accordion component using Vue 3. By following best practices for accessibility, we ensure that our component is not only functional but also inclusive and reliable for all users.
In Part 2, we will cover writing unit tests for the accordion component. You can find [part 2 here](/posts/adding-unit-tests-to-our-accordion/).

[View Demo on Vue SFC Playground](https://play.vuejs.org/#eNqtWH1P20YY/yo3d1qCljhQVmlLk7asZSubVtCgfxGkGvsSu1x87vkcQCjffc9zbz4njgWsqFLse95+97y7D8FRUYSrigbjYFLGIiskKamsijeznJBsWXAhyUVKj+KYiyTjOZkLviS9cOQfooLe61mOMjHPS9QRSyCUZEou8ZSQB/1DSMmqxZj0DMfwoDewlJRGSZYj8VwTiUcEvZLmEojv9ROZc2HtAKPmWxv+XdZedlnziN3WXj7S2mGXNY/Ybe3QWsOfK3DzZKQjBTGCF0mXBYskVRGDqJA6Vh/okuPppBFBrW1sQzSdBfZxFiBtpDRNUmGeTvJMZhEjpwXNafJ0fUDLtArU4JEvD65C9Fi72Y+HpCppolxhvPcc20b0CGnpYbupc8Zl+XTlShaEbATIC5fUQ2PWsECKPLiauNy/Cg2ZrFVQ8e+nF7+++u3Va2N0MmqEdYcRkzfOyEWalQT+Le9JXJUSCtVwEJlGEih5T5KEzjOIY2iFJtlyQUoRo3+kLMajEdiJ6TDlLAkzOTp4tT8LjKO2gE0afQCOGvRgEMgSIMyzRfi15Dk0GVUqsyDmyyJjVJwWxp9jW0SzIGKM3/6lzqSoqKkSkElpfNNy/rW8w7NZcCZoScWKzgJHk5FYUKnJx+ef6B08O+KSJxUD7g7iv7TkrEKMmu33Kk8Atsen0J6oRgkBvSiP78Dhpb0UAkVO3SlmATTK9x1Xr+Eehr8ouVm+Bi9uNlvs1s04JNnKpE7MohJzNbICw4XgVWHrQdC5T/wTacfMUpNIRkNJSznMkl06bCbUJluMWoWErIZQwUDqm7wdkCxP6N0e/LiSqLnHN/S+LjSvPTi7YBmzh+eQ1/ak7da2ZzjV2IdUF7AdoSY51aD8upLSFf8u5ZrJ102IvC8oMLWRxsqbX3588O+1thC/bDBHIouG9K6IwE8oF1dCwGWPzckJuo9Mp1PtyDZhLHvBmdeyGp7Uf+/A1Qm/xY6cgmJG/6b3n12eGJ45h07iOP7At5ONy70reAZdRlQF8Em+WDB6ThmYpclZlFPW1/H2hTx/g8dLaL9knEdLdF+HkxpSfkttaae6V6FmP7YjHZw6k0YuldQwNad+ZrdFH+JAXcmoouIMsQu6aKS+DQeLriljNLnG1H5UFozTLEnUsGwN/g918D2gOst2BXw1LFN++4R08h3XHSIzZTZD5AXIziE/QBvhmYzA7W7K2Gf71Jgr8LprV33ABjeAubcsKkjAAeH5P7wC4wlZm90Vl1V/Vy0EL3BR1YPxDN/6piPb/gQtWpX3mBwJEd0PwMi3KhM00R3eLYKutdQC51LAyQC1RxXDHS897DkBbzHaFDE86z0f62bfBthw335eMQZ8lktnuYJqGC6v9shoRD7xhLKsVH1Ts5pkUIXtckGJ7HsK21NGsQ0PGgBzmKKWbIPQ7++R6Rs75QSETORthsNVxMCZmIreDfRpyGi+kCkZkgObMG/JvpsaHep+1hLrvcYHSiHo6jvgdAjePgpyF07DtoGz0XcBa5+uQNzH2QFQZ2sICS45plaoKvx0HsawtfS3AA+IUh7qLQRxqAWkBtPS3BGSmedbkBrp4jB1EW0TAncOD8Bb6mUbhzeuWl2SzUm/O26QtSbAxttW9QP8JlDQoFepdeTyNpNxCnqBvFd/8cVRSUnvI1/S3rhubdqPmGPw+0FXfl87VP9t+R4/CtSsbbB1xXbf8V0LGt24N43oOE/+J6CufH4q1i5dndcAEX77uaivoo/9k2ddzpW/ft++z04wH2Bj2oTTPHsWINc3nwLovIAPtU0wx7iLPQlN2862M5pWUA1yU5VuxjY76NYtIRM2B5gmvA2/VVTcawhcHEF36oWb23bPDBqs774a2tDP3PhUOxF8nemvW79CVV3rtjLVwz60cz0EZn05+3WC8P3lRnWLLWNqNBokWjNax6bizLa71azChscsQ9qV6Fjvf3aC9X94Bk03)

[View Repo With Source](https://github.com/utroda/the-accordion)

`}function h(){return n}function C(){return[{depth:2,slug:"gather-requirements",text:"Gather Requirements"},{depth:4,slug:"accordions-have-two-primary-sections",text:"Accordions have two primary sections"},{depth:4,slug:"a11y-requirements",text:"A11y Requirements:"},{depth:2,slug:"the-component",text:"The Component"},{depth:4,slug:"define-props-and-refs",text:"Define Props and Refs"},{depth:4,slug:"markup",text:"Markup"},{depth:4,slug:"component-logic",text:"Component Logic"},{depth:4,slug:"keyboard-events",text:"Keyboard Events"},{depth:4,slug:"aria-support",text:"Aria Support"},{depth:2,slug:"conclusion",text:"Conclusion"}]}const f=e((o,c,d)=>{const{layout:r,...s}=F;return s.file=l,s.url=i,a`${t()}${p(n)}`});export{f as Content,h as compiledContent,f as default,l as file,F as frontmatter,C as getHeadings,E as rawContent,i as url};
